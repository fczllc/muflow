# 流程图 Vue 组件

## 1. 功能介绍

本组件旨在创建一个基于浏览器的交互式流程图编辑器，具备以下核心功能：

1. **可拖拽节点和连线绘制**
    - 用户可以通过拖拽操作在画布上创建矩形节点控件。
    - 用户可以通过拖拽锚点的方式，在节点之间创建连线，形成流程图结构。

2. **样式设置**
    - **线框样式：**  自定义矩形节点控件的边框样式（粗细、颜色）。
    - **字体样式：**  自定义节点和标签控件的字体样式（大小、颜色）。
    - **连线样式：**  自定义连线的样式（粗细、颜色、线型、双端箭头）。

3. **画布操作**
    - **JSON 保存与加载：**  API 将画布数据保存为 JSON 文件，并从 JSON 文件或字符串加载流程图。
    - **清除画布：**  一键清除画布上的所有节点和连线。

4. **文件标签控件**
    - 特殊的"文件标签"控件，无边框，无线连，支持字体样式设置和自动回行。

5. **控件连线操作**
    - 鼠标悬停显示锚点，拖拽锚点连线，智能选择圆角折线或直线。

6. **控件选中与大小调整**
    - 单击选中，显示锚点，拖拽调整大小，文字自适应，样式设置，`Delete` 键删除。

7. **辅助功能**
    - 清除画布按钮。
    - 多选对齐与分布（左对齐、右对齐、顶对齐、底对齐、水平/垂直居中对齐、水平/垂直均匀分布）。

## 2. 技术路线

本组件基于以下技术进行开发：

- **Vue Flow (@vue-flow/core):**  核心流程图库。
- **Vue 3.4.19:**  前端框架，使用 Composition API 进行组件开发。
- **TypeScript:**  类型系统，提高代码可维护性和可读性。

**关键技术点：**

- **Vue Flow 二次开发：**  利用 Vue Flow 提供的组件和 API 构建流程图编辑器框架。
- **自定义节点和连线：**  通过 Vue Flow 的 slot 功能，自定义节点和连线的样式和交互行为。
- **状态管理：**  使用 Vue Flow 提供的 `useVueFlow` composable 管理流程图状态。
- **样式定制：**  利用 CSS 类、CSS 属性和 CSS 变量定制组件样式。
- **JSON 序列化与反序列化：**  实现流程图数据的 JSON 保存和加载。
- **对齐和分布算法：**  实现节点的对齐和分布算法。

## 3. 开发计划

**总计时间：约 6 周**

**阶段任务：**

1. **第一阶段：静态 UI 页面实现 (预计 0.5 周)**
    - [ ] 搭建静态 UI 页面框架 (HTML, CSS, Vue 组件)。
    - [ ] 实现顶部工具栏、左侧控件栏和主画布窗口的静态布局。
    - [ ] 使用图标占位符。
    - [ ] **不实现交互功能。**

2. **第二阶段：环境搭建与 Vue Flow 集成 (预计 0.5 周)**
    - [ ] 搭建 Vue 3.4.19 + TypeScript 开发环境。
    - [ ] 安装 Vue Flow 核心库。
    - [ ] 在主画布窗口集成 Vue Flow 组件。
    - [ ] 实现 Vue Flow 画布基本渲染。

3. **第三阶段：基础功能实现 (预计 1 周)**
    - [ ] 实现矩形节点和连线拖拽绘制。
    - [ ] 实现节点选中、拖动和删除。
    - [ ] 实现左侧控件栏拖拽创建节点。

4. **第四阶段：样式定制与增强功能 (预计 2 周)**
    - [ ] 实现线框样式、字体样式和连线样式设置 (与顶部工具栏联动)。
    - [ ] 实现文件标签控件。
    - [ ] 完善控件连线操作 (锚点、拖拽、智能连线)。
    - [ ] 实现控件大小调整和文字自适应。
    - [ ] 实现双击编辑节点文字。

5. **第五阶段：JSON 保存加载与辅助功能 (预计 1.5 周)**
    - [ ] 实现画布 JSON 保存和加载 (与顶部工具栏联动)。
    - [ ] 实现清除画布按钮和功能 (与顶部工具栏联动)。
    - [ ] 实现导出图片功能 (与顶部工具栏联动)。
    - [ ] 实现多选节点对齐和分布。
    - [ ] 替换图标占位符，完善 UI 交互细节。
    - [ ] 编写组件文档和示例。

6. **第六阶段：测试与优化 (预计 0.5 周)**
    - [ ] 功能测试和兼容性测试。
    - [ ] Bug 修复和性能优化。
    - [ ] 完善文档和示例。

**请注意：**  本开发计划为初步计划，后续将根据实际开发进度进行更新和调整。

---

**后续扩展方向 (可选):**

- 更多节点类型
- 分组功能
- 撤销/重做
- 数据验证
- 动态数据绑定
- 流程图布局算法 